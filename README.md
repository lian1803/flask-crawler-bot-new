# 🏫 파주와석초등학교 AI 챗봇 v3.0

## 📋 프로젝트 개요

파주와석초등학교의 학부모와 학생들을 위한 AI 기반 카카오톡 챗봇입니다. 기존 챗봇의 답변 로직을 개선하여 더 자연스럽고 정확한 응답을 제공합니다.

## ✨ 주요 기능

### 🤖 AI 기반 대화 시스템
- **OpenAI GPT-3.5-turbo** 활용한 자연스러운 대화
- **대화 히스토리 관리**로 맥락 이해 개선
- **토큰 관리**로 효율적인 API 사용

### 📚 학교 정보 제공
- **급식 정보**: 오늘, 내일, 특정 날짜의 급식 메뉴
- **공지사항**: 최신 학교 공지사항 및 알림
- **QA 데이터베이스**: 학교 운영, 제도, 행사 등 질문 답변

### 🔄 자동화 시스템
- **매일 자정 자동 엑셀 데이터 업데이트**
- **스케줄러 기반 백그라운드 작업**
- **데이터베이스 상태 모니터링**

## 🏗️ 시스템 구조

```
new/
├── app.py                 # 메인 애플리케이션
├── config.py             # 설정 관리
├── database.py           # 데이터베이스 관리
├── utils.py              # 유틸리티 함수
├── requirements.txt      # 의존성 목록
├── README.md            # 프로젝트 설명서
└── logic/
    ├── bot_logic.py      # 봇 로직 (AI 처리)
    └── prompt.txt        # AI 프롬프트
```

## 🚀 설치 및 실행

### 1. 의존성 설치
```bash
pip install -r requirements.txt
```

### 2. 환경변수 설정
`.env` 파일을 생성하고 다음 변수들을 설정하세요:

```env
# API 설정
OPENAI_API_KEY=your_openai_api_key
API_TOKEN=your_api_token
BASE_URL=https://ganglia.machaao.com

# 서버 설정
PORT=5000

# 봇 설정
BOT_NAME=와석초 챗봇
BOT_PERSONALITY=친근하고 도움이 되는 학교 챗봇

# AI 모델 설정
OPENAI_MODEL=gpt-3.5-turbo
TEMPERATURE=0.7
MAX_TOKENS=150

# 데이터베이스 설정
DB_PATH=school_data.db
EXCEL_FILE=와석초 카카오톡 챗봇 개발을 위한 질문과 답변 의 사본.xlsx
```

### 3. 애플리케이션 실행
```bash
python app.py
```

## 📊 답변 처리 로직

### 1단계: 인사말 처리
- 사용자의 인사말을 인식하고 친근한 응답 제공

### 2단계: 급식 정보 처리
- 급식 관련 키워드 감지
- 날짜 추출 및 해당 날짜 급식 정보 제공

### 3단계: 공지사항 처리
- 공지사항 관련 키워드 감지
- 최신 공지사항 목록 제공

### 4단계: QA 데이터베이스 검색
- 정확한 질문 매칭 시도
- 키워드 기반 유사 질문 검색

### 5단계: AI 응답 생성
- OpenAI API를 사용한 자연스러운 답변 생성
- 대화 히스토리와 학교 데이터베이스 정보 활용

## 🔧 관리 기능

### 웹 테스트 페이지
- `http://localhost:5000/test` 접속
- 시스템 상태 확인
- 데이터베이스 상태 확인
- 엑셀 데이터 업데이트
- 실시간 챗봇 테스트

### API 엔드포인트
- `GET /system-status`: 시스템 상태 확인
- `GET /db-status`: 데이터베이스 상태 확인
- `POST /update-excel`: 수동 엑셀 데이터 업데이트
- `POST /test-chat`: 챗봇 테스트

## 📈 개선 사항

### 기존 챗봇 대비 개선점
1. **모듈화된 구조**: 기능별 파일 분리로 유지보수성 향상
2. **AI 기반 답변**: 자연스러운 대화 가능
3. **대화 히스토리**: 맥락 이해 개선
4. **토큰 관리**: 효율적인 API 사용
5. **에러 처리**: 체계적인 예외 처리
6. **테스트 기능**: 웹 기반 테스트 페이지

### 기술적 개선
- **temp_machaao** 템플릿의 AI 로직 적용
- **rol** 프로젝트의 학교 데이터베이스 통합
- **대화 히스토리 관리** 시스템 추가
- **프롬프트 엔지니어링** 적용

## 🛠️ 개발 환경

- **Python**: 3.8+
- **Flask**: 2.3.3
- **OpenAI**: 1.3.0
- **SQLite**: 내장 데이터베이스
- **APScheduler**: 백그라운드 작업

## 📝 라이선스

이 프로젝트는 파주와석초등학교 전용으로 개발되었습니다.

## 🤝 기여

프로젝트 개선을 위한 제안이나 버그 리포트는 언제든 환영합니다.

---

**개발**: AI 기반 챗봇 시스템  
**버전**: 3.0  
**최종 업데이트**: 2024년 